
> ptak-expo-backend@1.0.0 start
> node src/index.js

ğŸ” Starting PTAK EXPO Backend...
ğŸ” Node.js version: v20.19.1
ğŸ” Environment: development
ğŸ” Port from env: 3001
ğŸ” DATABASE_URL: SET (length: 93)
ğŸ” JWT_SECRET: SET (length: 41)
ğŸ” CORS_ORIGIN: http://localhost:3000
ğŸ” Railway Environment Variables:
  - RAILWAY_ENVIRONMENT: not set
  - RAILWAY_SERVICE_NAME: not set
  - RAILWAY_DEPLOYMENT_ID: not set
ğŸ” Local development environment, using local database
ğŸ” Database config - Selected URL: SET (starts with: postgresql://postgre...)
ğŸ” Database config - NODE_ENV: development
ğŸ” Database config - RAILWAY_ENVIRONMENT: not set
ğŸ” Database config - SSL mode: disabled
ğŸ” Database pool created
ğŸ” Database module loaded - initialization will be handled by server startup
ğŸ” Swagger spec loaded from /Users/kid/Ptak-expo/ptak-expo-backend/swagger.yaml
ğŸ” Loading database config...
ğŸ” Will listen on port: 3001
ğŸ” CORS allowed origins: [
  'http://localhost:3000',
  'http://localhost:3002',
  'http://localhost:3003',
  'http://localhost:3000',
  'https://frontend-production-fb96.up.railway.app',
  'https://ptak-expo-production.up.railway.app'
]
ğŸ“˜ Swagger UI available at /api-docs
ğŸš€ PTAK EXPO Backend API running on port 3001
ğŸ“Š Environment: development
ğŸ”— Health check: http://localhost:3001/
ğŸ” DATABASE_URL: Set
ğŸ” JWT_SECRET: Set
ğŸ” Server started successfully, initializing database in background...
ğŸ” Starting database initialization...
ğŸ” Testing database connection...
ğŸ’¾ Connected to PostgreSQL database
âœ… Database connection test successful
ğŸ” Creating users table...
ğŸ” Checking status column...
âœ… Status column already exists
ğŸ” Current users table structure:
  - id: integer NOT NULL DEFAULT nextval('users_id_seq'::regclass)
  - email: character varying NOT NULL 
  - password_hash: character varying NOT NULL 
  - role: character varying NOT NULL DEFAULT 'guest'::character varying
  - first_name: character varying NULL 
  - last_name: character varying NULL 
  - company_name: character varying NULL 
  - phone: character varying NULL 
  - status: character varying NULL DEFAULT 'active'::character varying
  - created_at: timestamp with time zone NULL DEFAULT now()
  - updated_at: timestamp with time zone NULL DEFAULT now()
ğŸ” Creating exhibitions table...
ğŸ” Creating documents table...
ğŸ” Creating marketing_materials table...
ğŸ” Creating communications table...
ğŸ” Creating invitations table...
ğŸ” Creating exhibitors table...
ğŸ” Creating exhibitor_events table...
ğŸ” Creating exhibitor_branding_files table...
ğŸ” Creating indexes for exhibitor_branding_files table...
ğŸ” Creating trade_info table...
ğŸ” Creating trade_build_days table...
ğŸ” Creating trade_spaces table...
ğŸ” Creating invitation_templates table...
ğŸ” Creating invitation_recipients table...
ğŸ” Creating exhibitor_documents table...
ğŸ” Creating indexes for trade_info and invitations tables...
ğŸ” Creating trade_events table...
ğŸ” Inserting admin user...
ğŸ” Inserting test users...
ğŸ” Inserting test exhibitors...
ğŸ” Skipping test exhibitions insertion (disabled to prevent auto-creation)
âœ… Database tables initialized successfully
âœ… Database initialization completed
Fetching events for user 983 (ja4@ja.com)
Found linked exhibitor 767 for user ja4@ja.com
Found 1 assigned events for exhibitor 767
Fetching events for user 983 (ja4@ja.com)
Found linked exhibitor 767 for user ja4@ja.com
Found 1 assigned events for exhibitor 767
ğŸ’¾ Connected to PostgreSQL database
ğŸ” [trade-events] listByExhibition { exhibitionId: 672, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] listByExhibition { exhibitionId: 672, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] listByExhibition { exhibitionId: 672, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] listByExhibition { exhibitionId: 672, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] listByExhibition { exhibitionId: 672, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] create request {
  exhibitionId: 672,
  body: {
    name: 'dasda',
    description: 'sdasdsad',
    eventDate: '2025-09-28',
    startTime: '08:30',
    endTime: '09:30',
    type: 'Prezentacja',
    exhibitor_id: 767
  },
  user: 'ja4@ja.com'
}
âš ï¸  [trade-events] date out of range {
  eventDate: '2025-09-28',
  startDate: 2025-08-27T22:00:00.000Z,
  endDate: 2025-08-30T22:00:00.000Z
}
ğŸ” [trade-events] listByExhibition { exhibitionId: 672, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] listByExhibition { exhibitionId: 672, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] listByExhibition { exhibitionId: 672, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] create request {
  exhibitionId: 672,
  body: {
    name: 'sadd',
    description: 'sadsadasd',
    eventDate: '2025-09-28',
    startTime: '08:30',
    endTime: '09:30',
    type: 'Prezentacja',
    exhibitor_id: 767
  },
  user: 'ja4@ja.com'
}
âš ï¸  [trade-events] date out of range {
  eventDate: '2025-09-28',
  startDate: 2025-08-27T22:00:00.000Z,
  endDate: 2025-08-30T22:00:00.000Z
}
ğŸ” [trade-events] listByExhibition { exhibitionId: 672, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] listByExhibition { exhibitionId: 672, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] listByExhibition { exhibitionId: 672, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] create request {
  exhibitionId: 672,
  body: {
    name: 'Wydddd',
    description: 'Opis ',
    eventDate: '2025-08-29',
    startTime: '09:30',
    endTime: '11:00',
    type: 'Prezentacja',
    exhibitor_id: 767
  },
  user: 'ja4@ja.com'
}
âœ… [trade-events] created {
  id: 9,
  exhibition_id: 672,
  name: 'Wydddd',
  event_date: 2025-08-28T22:00:00.000Z,
  start_time: '09:30:00',
  end_time: '11:00:00',
  hall: null,
  description: 'Opis ',
  type: 'Prezentacja',
  created_at: 2025-08-31T19:28:54.780Z,
  updated_at: 2025-08-31T19:28:54.780Z,
  exhibitor_id: 767,
  organizer: null
}
ğŸ” [trade-events] listByExhibition { exhibitionId: 672, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] listByExhibition { exhibitionId: 672, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] listByExhibition { exhibitionId: 672, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ’¾ Connected to PostgreSQL database
ğŸ” [trade-events] listByExhibition { exhibitionId: 672, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] listByExhibition { exhibitionId: 672, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ’¾ Connected to PostgreSQL database
ğŸ’¾ Connected to PostgreSQL database
ğŸ’¾ Connected to PostgreSQL database
ğŸ” [trade-events] listByExhibition { exhibitionId: 672, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] listByExhibition { exhibitionId: 672, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ’¾ Connected to PostgreSQL database
Fetching events for user 983 (ja4@ja.com)
Found linked exhibitor 767 for user ja4@ja.com
Found 1 assigned events for exhibitor 767
Fetching exhibitors from database...
Fetching exhibitors from database...
ğŸ’¾ Connected to PostgreSQL database
Found 10 exhibitors
Found 10 exhibitors
ğŸ” [trade-events] listByExhibition { exhibitionId: 672, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] listByExhibition { exhibitionId: 672, exhibitorId: 767, user: 'ja4@ja.com' }
Fetching exhibitor with ID: 21
Fetching exhibitor with ID: 21
Fetching exhibitors from database...
Fetching exhibitors from database...
Found 10 exhibitors
Found 10 exhibitors
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching users from database...
Fetching exhibitions from database...
Found 11 users
Found 11 exhibitions
Assigning exhibitor 767 to exhibition 718
With supervisor user id: 1
âœ… Exhibitor Firma Digi 3 assigned to exhibition Batman kot
Fetching exhibitor with ID: 767
Fetching exhibitions from database...
Fetching exhibitions from database...
Found 11 exhibitions
Found 11 exhibitions
Fetching exhibitors from database...
Fetching exhibitors from database...
Found 10 exhibitors
Found 10 exhibitors
Fetching exhibitor with ID: 667
Fetching exhibitor with ID: 667
Fetching exhibitions from database...
Fetching exhibitions from database...
Found 11 exhibitions
Found 11 exhibitions
Fetching exhibitions from database...
Fetching exhibitions from database...
Found 11 exhibitions
Found 11 exhibitions
Fetching exhibitors from database...
Fetching exhibitors from database...
Found 10 exhibitors
Found 10 exhibitors
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitors from database...
Fetching exhibitors from database...
Found 10 exhibitors
Found 10 exhibitors
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitors from database...
Fetching exhibitors from database...
Found 10 exhibitors
Found 10 exhibitors
Fetching exhibitors from database...
Fetching exhibitors from database...
Found 10 exhibitors
Found 10 exhibitors
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitors from database...
Fetching exhibitors from database...
Found 10 exhibitors
Found 10 exhibitors
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
ğŸ’¾ Connected to PostgreSQL database
ğŸ’¾ Connected to PostgreSQL database
ğŸ’¾ Connected to PostgreSQL database
ğŸ’¾ Connected to PostgreSQL database
ğŸ’¾ Connected to PostgreSQL database
ğŸ’¾ Connected to PostgreSQL database
ğŸ’¾ Connected to PostgreSQL database
Fetching exhibitions from database...
Fetching exhibitions from database...
ğŸ’¾ Connected to PostgreSQL database
ğŸ’¾ Connected to PostgreSQL database
Found 11 exhibitions
Found 11 exhibitions
ğŸ’¾ Connected to PostgreSQL database
ğŸ’¾ Connected to PostgreSQL database
ğŸ” Getting trade info for exhibition: 718
ğŸ” Getting trade info for exhibition: 718
Fetching invitations for exhibition 718...
Fetching invitations for exhibition 718...
ğŸ” [trade-events] listByExhibition {
  exhibitionId: 718,
  exhibitorId: null,
  user: 'test.admin@ptak-expo.com'
}
ğŸ” [trade-events] listByExhibition {
  exhibitionId: 718,
  exhibitorId: null,
  user: 'test.admin@ptak-expo.com'
}
Fetching exhibitors from database...
Fetching exhibitors from database...
Found 10 exhibitors
Found 10 exhibitors
Fetching exhibitor with ID: 767
Fetching exhibitor with ID: 767
Fetching events for user 983 (ja4@ja.com)
Found linked exhibitor 767 for user ja4@ja.com
Found 2 assigned events for exhibitor 767
Fetching events for user 983 (ja4@ja.com)
Fetching events for user 983 (ja4@ja.com)
Found linked exhibitor 767 for user ja4@ja.com
Found 2 assigned events for exhibitor 767
Found linked exhibitor 767 for user ja4@ja.com
Found 2 assigned events for exhibitor 767
ğŸ” [trade-events] listByExhibition { exhibitionId: 672, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] listByExhibition { exhibitionId: 672, exhibitorId: 767, user: 'ja4@ja.com' }
Fetching events for user 983 (ja4@ja.com)
Found linked exhibitor 767 for user ja4@ja.com
Found 2 assigned events for exhibitor 767
Fetching events for user 983 (ja4@ja.com)
Found linked exhibitor 767 for user ja4@ja.com
Found 2 assigned events for exhibitor 767
Fetching events for user 983 (ja4@ja.com)
Found linked exhibitor 767 for user ja4@ja.com
Found 2 assigned events for exhibitor 767
Fetching events for user 983 (ja4@ja.com)
Found linked exhibitor 767 for user ja4@ja.com
Found 2 assigned events for exhibitor 767
Fetching events for user 983 (ja4@ja.com)
Found linked exhibitor 767 for user ja4@ja.com
Found 2 assigned events for exhibitor 767
Fetching events for user 983 (ja4@ja.com)
Found linked exhibitor 767 for user ja4@ja.com
Found 2 assigned events for exhibitor 767
ğŸ” Getting trade info for exhibition: 718
ğŸ” Getting trade info for exhibition: 718
ğŸ’¾ Connected to PostgreSQL database
ğŸ” [trade-events] listByExhibition { exhibitionId: 718, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] listByExhibition { exhibitionId: 718, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ’¾ Connected to PostgreSQL database
ğŸ’¾ Connected to PostgreSQL database
ğŸ” Getting trade info for exhibition: 718
ğŸ’¾ Connected to PostgreSQL database
Fetching events for user 983 (ja4@ja.com)
Found linked exhibitor 767 for user ja4@ja.com
Found 2 assigned events for exhibitor 767
Fetching events for user 983 (ja4@ja.com)
Fetching events for user 983 (ja4@ja.com)
Found linked exhibitor 767 for user ja4@ja.com
Found linked exhibitor 767 for user ja4@ja.com
Found 2 assigned events for exhibitor 767
Found 2 assigned events for exhibitor 767
Fetching events for user 983 (ja4@ja.com)
Fetching events for user 983 (ja4@ja.com)
Found linked exhibitor 767 for user ja4@ja.com
Found linked exhibitor 767 for user ja4@ja.com
Found 2 assigned events for exhibitor 767
Found 2 assigned events for exhibitor 767
ğŸ’¾ Connected to PostgreSQL database
Fetching events for user 983 (ja4@ja.com)
Found linked exhibitor 767 for user ja4@ja.com
Found 2 assigned events for exhibitor 767
Fetching events for user 983 (ja4@ja.com)
Found linked exhibitor 767 for user ja4@ja.com
Found 2 assigned events for exhibitor 767
ğŸ’¾ Connected to PostgreSQL database
ğŸ” Getting trade info for exhibition: 718
ğŸ” Getting trade info for exhibition: 718
ğŸ’¾ Connected to PostgreSQL database
ğŸ” [trade-events] listByExhibition { exhibitionId: 718, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] listByExhibition { exhibitionId: 718, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ’¾ Connected to PostgreSQL database
ğŸ’¾ Connected to PostgreSQL database
ğŸ’¾ Connected to PostgreSQL database
ğŸ” [trade-events] listByExhibition { exhibitionId: 718, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] listByExhibition { exhibitionId: 718, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ’¾ Connected to PostgreSQL database
ğŸ’¾ Connected to PostgreSQL database
ğŸ” [trade-events] listByExhibition { exhibitionId: 718, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] listByExhibition { exhibitionId: 718, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ’¾ Connected to PostgreSQL database
ğŸ” [trade-events] listByExhibition { exhibitionId: 718, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] listByExhibition { exhibitionId: 718, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] listByExhibition { exhibitionId: 718, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] listByExhibition { exhibitionId: 718, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ’¾ Connected to PostgreSQL database
ğŸ’¾ Connected to PostgreSQL database
ğŸ’¾ Connected to PostgreSQL database
ğŸ” [trade-events] listByExhibition { exhibitionId: 718, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] listByExhibition { exhibitionId: 718, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ’¾ Connected to PostgreSQL database
ğŸ’¾ Connected to PostgreSQL database
ğŸ” [trade-events] listByExhibition { exhibitionId: 718, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] listByExhibition { exhibitionId: 718, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” Getting trade info for exhibition: 718
ğŸ’¾ Connected to PostgreSQL database
ğŸ” Getting trade info for exhibition: 718
ğŸ” [trade-events] listByExhibition { exhibitionId: 718, exhibitorId: 767, user: 'ja4@ja.com' }
ğŸ” [trade-events] listByExhibition { exhibitionId: 718, exhibitorId: 767, user: 'ja4@ja.com' }
